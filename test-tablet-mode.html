<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tablet Mode Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background: #f5f5f5;
        }
        
        .test-container {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            max-width: 800px;
            margin: 0 auto;
        }
        
        .viewport-info {
            background: #e3f2fd;
            padding: 15px;
            border-radius: 4px;
            margin-bottom: 20px;
        }
        
        .mode-info {
            background: #f3e5f5;
            padding: 15px;
            border-radius: 4px;
            margin-bottom: 20px;
        }
        
        .sidebar-info {
            background: #e8f5e8;
            padding: 15px;
            border-radius: 4px;
            margin-bottom: 20px;
        }
        
        .resize-instructions {
            background: #fff3cd;
            padding: 15px;
            border-radius: 4px;
            border: 1px solid #ffeaa7;
        }
        
        button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        
        button:hover {
            background: #0056b3;
        }
        
        .log {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            padding: 10px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            max-height: 300px;
            overflow-y: auto;
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>üß™ Tablet Mode Sidebar Test</h1>
        
        <div class="viewport-info">
            <h3>üìê Current Viewport</h3>
            <p><strong>Width:</strong> <span id="viewport-width">-</span>px</p>
            <p><strong>Height:</strong> <span id="viewport-height">-</span>px</p>
            <p><strong>Mode:</strong> <span id="viewport-mode">-</span></p>
        </div>
        
        <div class="mode-info">
            <h3>üéØ Responsive Mode</h3>
            <p><strong>Type:</strong> <span id="mode-type">-</span></p>
            <p><strong>Is Mobile:</strong> <span id="mode-mobile">-</span></p>
            <p><strong>Is Tablet:</strong> <span id="mode-tablet">-</span></p>
            <p><strong>Is Desktop:</strong> <span id="mode-desktop">-</span></p>
        </div>
        
        <div class="sidebar-info">
            <h3>üìè Sidebar Configuration</h3>
            <p><strong>Is Visible:</strong> <span id="sidebar-visible">-</span></p>
            <p><strong>Can Toggle:</strong> <span id="sidebar-toggle">-</span></p>
            <p><strong>Default Width:</strong> <span id="sidebar-default">-</span>px</p>
            <p><strong>Compact Width:</strong> <span id="sidebar-compact">-</span>px</p>
        </div>
        
        <div class="resize-instructions">
            <h3>üîß Test Instructions</h3>
            <p><strong>Desktop Mode:</strong> Resize browser to > 1024px width</p>
            <p><strong>Tablet Mode:</strong> Resize browser to 769-1024px width</p>
            <p><strong>Mobile Mode:</strong> Resize browser to ‚â§ 768px width</p>
            <br>
            <button onclick="simulateResize(1200)">Simulate Desktop (1200px)</button>
            <button onclick="simulateResize(900)">Simulate Tablet (900px)</button>
            <button onclick="simulateResize(600)">Simulate Mobile (600px)</button>
            <button onclick="updateDisplay()">Refresh Data</button>
            <button onclick="clearLog()">Clear Log</button>
        </div>
        
        <div class="log" id="log">
            <div><strong>Log Output:</strong></div>
        </div>
    </div>

    <script type="module">
        // Import LayoutContext
        import LayoutContext from './src/contexts/LayoutContext.js';
        
        let layoutContext;
        
        function log(message) {
            const logDiv = document.getElementById('log');
            const timestamp = new Date().toLocaleTimeString();
            logDiv.innerHTML += `<div>[${timestamp}] ${message}</div>`;
            logDiv.scrollTop = logDiv.scrollHeight;
        }
        
        function updateDisplay() {
            try {
                const width = window.innerWidth;
                const height = window.innerHeight;
                
                // Update viewport info
                document.getElementById('viewport-width').textContent = width;
                document.getElementById('viewport-height').textContent = height;
                
                const isMobile = width <= 768;
                const isTablet = width > 768 && width <= 1024;
                const isDesktop = width > 1024;
                
                let mode = 'Unknown';
                if (isMobile) mode = 'Mobile';
                else if (isTablet) mode = 'Tablet';
                else if (isDesktop) mode = 'Desktop';
                
                document.getElementById('viewport-mode').textContent = mode;
                
                if (layoutContext) {
                    const responsiveMode = layoutContext.getResponsiveMode();
                    
                    // Update mode info
                    document.getElementById('mode-type').textContent = responsiveMode.type;
                    document.getElementById('mode-mobile').textContent = responsiveMode.isMobile;
                    document.getElementById('mode-tablet').textContent = responsiveMode.isTablet;
                    document.getElementById('mode-desktop').textContent = responsiveMode.isDesktop;
                    
                    // Update sidebar info
                    document.getElementById('sidebar-visible').textContent = responsiveMode.sidebarBehavior.isVisible;
                    document.getElementById('sidebar-toggle').textContent = responsiveMode.sidebarBehavior.canToggle;
                    document.getElementById('sidebar-default').textContent = responsiveMode.sidebarBehavior.defaultWidth;
                    document.getElementById('sidebar-compact').textContent = responsiveMode.sidebarBehavior.compactWidth;
                    
                    log(`Viewport: ${width}x${height} (${mode}) | Sidebar: ${responsiveMode.sidebarBehavior.isVisible ? 'Visible' : 'Hidden'} | Default: ${responsiveMode.sidebarBehavior.defaultWidth}px`);
                } else {
                    log('LayoutContext not initialized');
                }
            } catch (error) {
                log(`Error: ${error.message}`);
            }
        }
        
        function simulateResize(width) {
            // This won't actually resize the browser, but will show what the values would be
            const height = window.innerHeight;
            
            const isMobile = width <= 768;
            const isTablet = width > 768 && width <= 1024;
            const isDesktop = width > 1024;
            
            let mode = 'Unknown';
            let defaultWidth = 280;
            let compactWidth = 80;
            
            if (isMobile) {
                mode = 'Mobile';
                defaultWidth = 0; // Hidden
                compactWidth = 0;
            } else if (isTablet) {
                mode = 'Tablet';
                defaultWidth = 240;
                compactWidth = 64;
            } else if (isDesktop) {
                mode = 'Desktop';
                defaultWidth = 280;
                compactWidth = 80;
            }
            
            const isVisible = !isMobile;
            
            log(`SIMULATION: ${width}x${height} (${mode}) | Visible: ${isVisible} | Default: ${defaultWidth}px | Compact: ${compactWidth}px`);
        }
        
        function clearLog() {
            document.getElementById('log').innerHTML = '<div><strong>Log Output:</strong></div>';
        }
        
        // Make functions global
        window.simulateResize = simulateResize;
        window.updateDisplay = updateDisplay;
        window.clearLog = clearLog;
        
        // Initialize
        try {
            layoutContext = LayoutContext.getInstance();
            log('LayoutContext initialized successfully');
            
            // Subscribe to responsive mode changes
            layoutContext.subscribe('responsive-mode-change', (event) => {
                log(`Responsive mode changed to: ${event.data.type}`);
                updateDisplay();
            });
            
            // Initial display update
            updateDisplay();
            
            // Update on resize
            window.addEventListener('resize', () => {
                setTimeout(updateDisplay, 100); // Small delay to let LayoutContext process first
            });
            
        } catch (error) {
            log(`Initialization error: ${error.message}`);
        }
    </script>
</body>
</html>
